# À insérer JUSTE AVANT l'étape qui lance: bash run_collector_tests.sh
- name: Debug + fix collector (workspace-safe)
  shell: bash
  run: |
    set -euo pipefail
    echo "GITHUB_WORKSPACE=${GITHUB_WORKSPACE:-<unset>}"
    echo "PWD=$(pwd)"

    TARGET="${GITHUB_WORKSPACE}/scripts/phio_llm_collect.sh"
    echo "TARGET=$TARGET"

    echo "LS $GITHUB_WORKSPACE/scripts:"
    ls -la "${GITHUB_WORKSPACE}/scripts" || true

    echo "EXISTS?"; test -e "$TARGET" && echo YES || echo NO
    echo "EXEC?";   test -x "$TARGET" && echo YES || echo NO

    # Fix permissions (si le fichier existe)
    if test -e "$TARGET"; then
      chmod +x "$TARGET"
      echo "After chmod: EXEC?"; test -x "$TARGET" && echo YES || echo NO
    fi
